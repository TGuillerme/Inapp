<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Fitch Algorithm</title>
  <meta name="description" content="Inapplicable data in a parsimony setting">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="The Fitch Algorithm" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inapplicable data in a parsimony setting" />
  <meta name="github-repo" content="TGuillerme/Inapp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Fitch Algorithm" />
  
  <meta name="twitter:description" content="Inapplicable data in a parsimony setting" />
  

<meta name="author" content="Thomas Guillerme">


<meta name="date" content="2018-03-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="inapplicable-data-in-a-parsimony-setting-2.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Inapplicable data in a parsimony setting</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html"><i class="fa fa-check"></i><b>1</b> Inapplicable data in a parsimony setting</a><ul>
<li class="chapter" data-level="1.1" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html#the-fitch-algorithm"><i class="fa fa-check"></i><b>1.1</b> The Fitch algorithm</a><ul>
<li class="chapter" data-level="1.1.1" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html#downpass"><i class="fa fa-check"></i><b>1.1.1</b> Downpass</a></li>
<li class="chapter" data-level="1.1.2" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html#uppass"><i class="fa fa-check"></i><b>1.1.2</b> Uppass</a></li>
<li class="chapter" data-level="1.1.3" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html#discussion-how-to-optimise-characters"><i class="fa fa-check"></i><b>1.1.3</b> Discussion: How to optimise characters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html"><i class="fa fa-check"></i><b>2</b> Problems with the Fitch algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#red-tails-blue-tails"><i class="fa fa-check"></i><b>2.1</b> Red tails, blue tails</a></li>
<li class="chapter" data-level="2.2" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#why-reductive-coding-doesnt-work"><i class="fa fa-check"></i><b>2.2</b> Why Reductive coding doesn’t work</a><ul>
<li class="chapter" data-level="2.2.1" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#an-exception"><i class="fa fa-check"></i><b>2.2.1</b> An exception</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#why-extra-state-coding-doesnt-work"><i class="fa fa-check"></i><b>2.3</b> Why Extra State coding doesn’t work</a></li>
<li class="chapter" data-level="2.4" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#why-a-single-multi-state-character-doesnt-work"><i class="fa fa-check"></i><b>2.4</b> Why a single multi-state character doesn’t work</a></li>
<li class="chapter" data-level="2.5" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#sankoff-matrices"><i class="fa fa-check"></i><b>2.5</b> Sankoff matrices</a><ul>
<li class="chapter" data-level="2.5.1" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#symmetric"><i class="fa fa-check"></i><b>2.5.1</b> Symmetric</a></li>
<li class="chapter" data-level="2.5.2" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#gain-and-loss-asymmetric"><i class="fa fa-check"></i><b>2.5.2</b> Gain and loss asymmetric</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="problems-with-the-fitch-algorithm.html"><a href="problems-with-the-fitch-algorithm.html#conclusion"><i class="fa fa-check"></i><b>2.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-problem-with-counting-steps.html"><a href="the-problem-with-counting-steps.html"><i class="fa fa-check"></i><b>3</b> The problem with counting steps</a></li>
<li class="chapter" data-level="4" data-path="minimising-homoplasy.html"><a href="minimising-homoplasy.html"><i class="fa fa-check"></i><b>4</b> Minimising homoplasy</a><ul>
<li class="chapter" data-level="4.0.1" data-path="minimising-homoplasy.html"><a href="minimising-homoplasy.html#what-does-it-take-to-denote-separate-regions"><i class="fa fa-check"></i><b>4.0.1</b> What does it take to denote separate regions?</a></li>
<li class="chapter" data-level="4.1" data-path="minimising-homoplasy.html"><a href="minimising-homoplasy.html#how-this-fixes-the-problem"><i class="fa fa-check"></i><b>4.1</b> How this fixes the problem</a></li>
<li class="chapter" data-level="4.2" data-path="minimising-homoplasy.html"><a href="minimising-homoplasy.html#summary"><i class="fa fa-check"></i><b>4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html"><i class="fa fa-check"></i><b>5</b> Inapplicable data in a parsimony setting</a><ul>
<li class="chapter" data-level="5.1" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#implementation"><i class="fa fa-check"></i><b>5.1</b> Implementation</a><ul>
<li class="chapter" data-level="5.1.1" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#passes-1-2"><i class="fa fa-check"></i><b>5.1.1</b> Passes 1 &amp; 2</a></li>
<li class="chapter" data-level="5.1.2" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#pass-3"><i class="fa fa-check"></i><b>5.1.2</b> Pass 3</a></li>
<li class="chapter" data-level="5.1.3" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#pass-4"><i class="fa fa-check"></i><b>5.1.3</b> Pass 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html"><i class="fa fa-check"></i><b>6</b> Inapplicable data in a parsimony setting</a><ul>
<li class="chapter" data-level="6.1" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#multiple-dependencies"><i class="fa fa-check"></i><b>6.1</b> Multiple dependencies</a></li>
<li class="chapter" data-level="6.2" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#invariant-characters-can-inform-parsimony"><i class="fa fa-check"></i><b>6.2</b> Invariant characters can inform parsimony</a></li>
<li class="chapter" data-level="6.3" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#variable-but-parsimony-uninformative-characters-can-inform-parsimony"><i class="fa fa-check"></i><b>6.3</b> Variable but ‘parsimony uninformative’ characters can inform parsimony</a></li>
<li class="chapter" data-level="6.4" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#this-may-not-be-desirable-in-neomorphic-characters"><i class="fa fa-check"></i><b>6.4</b> This may not be desirable in neomorphic characters</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#three-scenarios"><i class="fa fa-check"></i><b>6.4.1</b> Three scenarios</a></li>
<li class="chapter" data-level="6.4.2" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#does-absence-contain-phylogenetic-information"><i class="fa fa-check"></i><b>6.4.2</b> Does absence contain phylogenetic information?</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#coding-ontologically-dependent-neomorphic-characters"><i class="fa fa-check"></i><b>6.5</b> Coding ontologically dependent neomorphic characters</a><ul>
<li class="chapter" data-level="6.5.1" data-path="inapplicable-data-in-a-parsimony-setting-2.html"><a href="inapplicable-data-in-a-parsimony-setting-2.html#neomorphic-and-transformational-characters"><i class="fa fa-check"></i><b>6.5.1</b> Neomorphic and transformational characters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ambiguity.html"><a href="ambiguity.html"><i class="fa fa-check"></i><b>7</b> Ambiguity</a><ul>
<li class="chapter" data-level="7.1" data-path="ambiguity.html"><a href="ambiguity.html#ambiguity-when-parent-character-ambiguous"><i class="fa fa-check"></i><b>7.1</b> Ambiguity when parent character ambiguous</a></li>
<li class="chapter" data-level="7.2" data-path="ambiguity.html"><a href="ambiguity.html#ambiguity-when-parent-character-known"><i class="fa fa-check"></i><b>7.2</b> Ambiguity when parent character known</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ambiguity.html"><a href="ambiguity.html#subordinate-character-has-finite-states"><i class="fa fa-check"></i><b>7.2.1</b> Subordinate character has finite states</a></li>
<li class="chapter" data-level="7.2.2" data-path="ambiguity.html"><a href="ambiguity.html#subordinate-character-may-have-unobserved-states"><i class="fa fa-check"></i><b>7.2.2</b> Subordinate character may have unobserved states</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ambiguity.html"><a href="ambiguity.html#recommendation-1"><i class="fa fa-check"></i><b>7.3</b> Recommendation</a></li>
<li class="chapter" data-level="7.4" data-path="ambiguity.html"><a href="ambiguity.html#some-caterpillars"><i class="fa fa-check"></i><b>7.4</b> Some caterpillars</a><ul>
<li class="chapter" data-level="7.4.1" data-path="ambiguity.html"><a href="ambiguity.html#three-equally-suboptimal-alternatives"><i class="fa fa-check"></i><b>7.4.1</b> Three equally suboptimal alternatives</a></li>
<li class="chapter" data-level="7.4.2" data-path="ambiguity.html"><a href="ambiguity.html#a-better-caterpillar-tree"><i class="fa fa-check"></i><b>7.4.2</b> A better caterpillar tree</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ambiguity.html"><a href="ambiguity.html#de-laets-caterpillars"><i class="fa fa-check"></i><b>7.5</b> De Laet’s caterpillars</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="8" data-path="inapplicable-data-in-a-parsimony-setting-3.html"><a href="inapplicable-data-in-a-parsimony-setting-3.html"><i class="fa fa-check"></i><b>8</b> Inapplicable data in a parsimony setting</a><ul>
<li class="chapter" data-level="8.1" data-path="inapplicable-data-in-a-parsimony-setting-3.html"><a href="inapplicable-data-in-a-parsimony-setting-3.html#the-packages"><i class="fa fa-check"></i><b>8.1</b> The packages</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/Inapp/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Fitch Algorithm</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ambiguity" class="section level1">
<h1><span class="header-section-number">7</span> Ambiguity</h1>
<p>Ambiguous data does not pose a problem for the algorithm, but the nature of the ambiguity must be considered when scoring a character.</p>
<div id="ambiguity-when-parent-character-ambiguous" class="section level2">
<h2><span class="header-section-number">7.1</span> Ambiguity when parent character ambiguous</h2>
<p>If it’s not clear whether or not a taxon has a tail, then tail colour should be coded as <code>?</code>, denoting that any possible token (including the inapplicable token) may be the most parsimonious for the tail.</p>
<p>In trees in which the tail can be reconstructed as present, the ambiguous tip will be reconstructed as having a tail of the appropriate colour:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-64-1.png" width="768" /></p>
<p>In trees in which the tail cannot be reconstructed as present without inferring a homoplasious origin, the tail colour will be reconstructed as inapplicable:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-65-1.png" width="768" /></p>
</div>
<div id="ambiguity-when-parent-character-known" class="section level2">
<h2><span class="header-section-number">7.2</span> Ambiguity when parent character known</h2>
<p>If a taxon is known to have a tail, there are two scenarios for ontologically dependent transformational characters:</p>
<div id="subordinate-character-has-finite-states" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Subordinate character has finite states</h3>
<p>If the subordinate character must take one of a finite set of values, then the unobserved property of the tail is known to belong to these values and should be coded accordingly.</p>
<p>For example:</p>
<ul>
<li>Tail: (0), absent; (1), present</li>
<li>Tail margin: (0), smooth; (1), serrated.</li>
</ul>
<p>Assume that the tail margin must either be smooth or serrated, and there is no reason to assume that either state is ancestral (i.e. the character is strictly transformational). Tail margin should then be coded as <code>{01}</code>: i.e. the tail is known to have taken one of the two states 0 or 1.</p>
</div>
<div id="subordinate-character-may-have-unobserved-states" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Subordinate character may have unobserved states</h3>
<p>A more complicated situation arises where a subordinate character may have unobserved states, as with</p>
<ul>
<li>Tail colour: (0), red; (1), blue.</li>
</ul>
<p>A taxon that is known to have a tail, but whose tail colour is uncertain, should generally be coded as <code>?</code>.</p>
<p>Coding it as <code>{01}</code> would be appropriate if the tail was known to certainly be homologous with other tails in the dataset, in which case it would be most parsimonious to assume that the tail colour is the same colour as the ancestor of the tip, which was necessarily either red or blue.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-66-1.png" width="384" /></p>
<p>But if, as will more often be the case, homology of the tails is not known <em>a priori</em>, then it is possible that this taxon has a tail that is not homologous with any other tail whose colour has been observed.</p>
<p>In this case, coding the tail colour as <code>{01}</code> states that the tail is the same colour as a tail that has already been observed. This means that the independent origin of the tail also represents an independent origin of this particular colour – and hence an instance of homoplasy.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-67-1.png" width="384" /></p>
<p>Coding the tail colour as <code>?</code> allows the possibility that the independently- evolved tail has a different colour to the tails already observed – green, perhaps. Reconstructing the tail colour as a colour that has not already been observed avoids an instance of homoplasy, and is therefore more parsimonious.</p>
<p>In the case that the unknown tail evolved independently and was green, the original character formulation – which only provides tokens for red and blue tails – cannot be applied and is thus inapplicable. Our algorithm will thus reconstruct tail colour as being inapplicable in such a taxon.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-68-1.png" width="384" /></p>
</div>
</div>
<div id="recommendation-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Recommendation</h2>
<p>We therefore recommend the following coding schema for ambiguous tips where the tail is (A) known to be present; (B) ambiguous; (C) known to be absent:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tail: (0), absent; (1), present.</td>
<td align="left">1</td>
<td align="left">?</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td>Tail margin: (0), smooth; (1), serrated.</td>
<td align="left">{01}</td>
<td align="left">?</td>
<td align="left">-</td>
</tr>
<tr class="odd">
<td>Tail colour: (0), red; (1), blue.</td>
<td align="left">?</td>
<td align="left">?</td>
<td align="left">-</td>
</tr>
</tbody>
</table>

<p>This vignette describes how the algorithm approaches some example trees. We follow the example of a tail coded using two characters:</p>
<ul>
<li>Tail: (0), absent; (1), present;</li>
<li>Tail colour: (0), red; (1), blue.</li>
</ul>
</div>
<div id="some-caterpillars" class="section level2">
<h2><span class="header-section-number">7.4</span> Some caterpillars</h2>
<p>First we’ll address some pectinate “caterpillar” trees, in which eight taxa have tails (and eight do not), four of which are red, four of which are blue.</p>
<p>An optimal tree with this character invokes a single origin of the tail, and a single change in tail colour, thus incurring a score of two. Here is one example:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-72-1.png" width="768" /></p>
<p>If we insist that the tail evolves twice, then the best score is accomplished by reconstructing a different colour of tail in each of the two regions in which the tail is present. On a caterpillar tree, this means the loss of a tail that has one colour, and an independent innovation in a tail-less taxon of a tail that has a different colour:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-73-1.png" width="768" /></p>
<p>Under the parsimony criterion, it is considered less optimal if a tail, when it re-evolves, happens to independently re-evolve a colour that has already been observed – “blueness” has evolved twice on the following tree, meaning that the second innovation of “blueness” represents an instance of homoplasy.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-74-1.png" width="768" /></p>
<div id="three-equally-suboptimal-alternatives" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Three equally suboptimal alternatives</h3>
<p>The following three trees differ in the number of innovations of the tail that are implied, and the number of changes in tail colour. All are equally parsimonious.</p>
<p>Under the first, our algorithm reconstructs the tail as ancestrally present, being lost on edge 2, gained on edge 5, lost in tips H and I, lost on edge 11, and gained on edge 14 (a total of six homoplasies). It further reconstructs independent, homoplastic origins of tail redness on edge 5, tail blueness on edge 14, and a change in tail colour from red to blue somewhere between edges 7 and 9 (three homoplasies).</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-75-1.png" width="768" /></p>
<p>In the second, our algorithm reconstructs the tail as ancestrally present, being lost in tips B, D, E, H, and I, and on edge 11, before being independently gained on edge 14 (a total of seven homoplasies).<br />
It further reconstructs an independent, homoplastic origins of tail blueness on edge 14, and a change in tail colour from red to blue somewhere between edges 7 and 9 (two homoplasies).</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-76-1.png" width="768" /></p>
<p>The third configuration reconstructs the tail as ancestrally present, being lost in tips B, D, F, H, J, L, N and P (a total of eight homoplastic losses). It further reconstructs a single change in tail colour from red to blue on edge 8.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-77-1.png" width="768" /></p>
</div>
<div id="a-better-caterpillar-tree" class="section level3">
<h3><span class="header-section-number">7.4.2</span> A better caterpillar tree</h3>
<p>The tree below obtains a better score than any of the previous three: it implies a loss of the tail at edge 2, a gain at edge 6, a loss at edge 10, and a gain at edge 14; it invokes a homoplastic origin of redness at edge 6, one of blueness at edge 14, and a change in colour at edge 8, for a combined score of 7.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-78-1.png" width="768" /></p>
</div>
</div>
<div id="de-laets-caterpillars" class="section level2">
<h2><span class="header-section-number">7.5</span> De Laet’s caterpillars</h2>
<p>De Laet <span class="citation">(<a href="#ref-DeLaet2017">2017</a>)</span> identifies a corner case in which our algorithm will not reconstruct every equally-parsimonious character reconstruction. Below is a simplified version of his example:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">C</th>
<th align="left">D</th>
<th align="left">E</th>
<th align="left">F</th>
<th align="left">G</th>
<th align="left">H</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tail: (0), absent; (1), present.</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">?</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td>Tail, colour: (1), red; (2),blue.</td>
<td align="left">-</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">?</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">2</td>
<td align="left">2</td>
</tr>
</tbody>
</table>
<p>When optimising tail colour, we reconstruct the tail as present at all internal nodes, with independent losses of the tail in each of the three tailless taxa (i.e. edges 1, 9, 11).</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-81-1.png" width="768" /></p>
<p>The Fitch algorithm identifies other reconstructions as equally parsimonious: for example, a tail may have been lost on edge 6 and re-gained on edge 12. This also incurs three steps for the tail character, and (in De Laet’s parlance) attributes three similarities to common ancestry: the presence of a tail in tips B and C, the absence of the tail in tips E and F, and the presence of a tail in tips G and H.</p>
<p>We prefer reconstructions that attribute the presence of a feature to common ancestry where possible – a philosophy that shares something with Dollo’s contention that it is easier to lose a feature than to gain it. On a pragmatic level, this maximises the opportunity for subsidiary traits of the tail to be attributed to common ancestry.</p>
<p>In this particular case, there is an equally-parsimonious character reconstruction that our algorithm excludes, which invokes two gains (and one loss) of the tail:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-82-1.png" width="768" /></p>
<p>This has no effect on tree scoring, but may be relevant if complete internal nodal reconstructions are desired.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-DeLaet2017">
<p>De Laet, J. (2017). A note on brazeau et al.’s (2017) algorithm for characters with inapplicable data, illustrated with an analysis of their fig. 3d using anagallis, a program for parsimony analysis of character hierarchies. doi:<a href="https://doi.org/10.13140/RG.2.2.31309.54245">10.13140/RG.2.2.31309.54245</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inapplicable-data-in-a-parsimony-setting-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/Inapp/inst/gitbook/edit/master/08_AmbiguousData.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
