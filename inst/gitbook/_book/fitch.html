<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Fitch Algorithm</title>
  <meta name="description" content="Inapplicable data in a parsimony setting">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="The Fitch Algorithm" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inapplicable data in a parsimony setting" />
  <meta name="github-repo" content="TGuillerme/Inapp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Fitch Algorithm" />
  
  <meta name="twitter:description" content="Inapplicable data in a parsimony setting" />
  

<meta name="author" content="Thomas Guillerme; Martin R. Smith">


<meta name="date" content="2018-03-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  

<link rel="next" href="problems.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color = initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Inapplicable data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="fitch.html"><a href="fitch.html"><i class="fa fa-check"></i><b>1</b> The Fitch algorithm</a><ul>
<li class="chapter" data-level="1.1" data-path="fitch.html"><a href="fitch.html#downpass"><i class="fa fa-check"></i><b>1.1</b> Downpass</a></li>
<li class="chapter" data-level="1.2" data-path="fitch.html"><a href="fitch.html#uppass"><i class="fa fa-check"></i><b>1.2</b> Uppass</a></li>
<li class="chapter" data-level="1.3" data-path="fitch.html"><a href="fitch.html#resolving-ambiguous-resolutions"><i class="fa fa-check"></i><b>1.3</b> Resolving ambiguous resolutions</a><ul>
<li class="chapter" data-level="1.3.1" data-path="fitch.html"><a href="fitch.html#maximising-homology"><i class="fa fa-check"></i><b>1.3.1</b> Maximising homology</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="problems.html"><a href="problems.html"><i class="fa fa-check"></i><b>2</b> Problems with the Fitch algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="problems.html"><a href="problems.html#red-tails-blue-tails"><i class="fa fa-check"></i><b>2.1</b> Red tails, blue tails</a></li>
<li class="chapter" data-level="2.2" data-path="problems.html"><a href="problems.html#reductive-coding"><i class="fa fa-check"></i><b>2.2</b> Reductive coding</a><ul>
<li class="chapter" data-level="2.2.1" data-path="problems.html"><a href="problems.html#an-exception"><i class="fa fa-check"></i><b>2.2.1</b> An exception</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="problems.html"><a href="problems.html#inapplicable-as-an-extra-state"><i class="fa fa-check"></i><b>2.3</b> Inapplicable as an extra state</a></li>
<li class="chapter" data-level="2.4" data-path="problems.html"><a href="problems.html#a-single-multi-state-character"><i class="fa fa-check"></i><b>2.4</b> A single multi-state character</a></li>
<li class="chapter" data-level="2.5" data-path="problems.html"><a href="problems.html#sankoff-matrices"><i class="fa fa-check"></i><b>2.5</b> Sankoff matrices</a><ul>
<li class="chapter" data-level="2.5.1" data-path="problems.html"><a href="problems.html#symmetric"><i class="fa fa-check"></i><b>2.5.1</b> Symmetric</a></li>
<li class="chapter" data-level="2.5.2" data-path="problems.html"><a href="problems.html#gain-and-loss-asymmetric"><i class="fa fa-check"></i><b>2.5.2</b> Gain and loss asymmetric</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="problems.html"><a href="problems.html#why-counting-steps-cannot-work"><i class="fa fa-check"></i><b>2.6</b> Why counting steps cannot work</a></li>
<li class="chapter" data-level="2.7" data-path="problems.html"><a href="problems.html#conclusion"><i class="fa fa-check"></i><b>2.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="solution.html"><a href="solution.html"><i class="fa fa-check"></i><b>3</b> A solution</a><ul>
<li class="chapter" data-level="3.1" data-path="solution.html"><a href="solution.html#minimising-homoplasy"><i class="fa fa-check"></i><b>3.1</b> Minimising homoplasy</a><ul>
<li class="chapter" data-level="3.1.1" data-path="solution.html"><a href="solution.html#what-does-it-take-to-denote-separate-regions"><i class="fa fa-check"></i><b>3.1.1</b> What does it take to denote separate regions?</a></li>
<li class="chapter" data-level="3.1.2" data-path="solution.html"><a href="solution.html#how-this-fixes-the-problem"><i class="fa fa-check"></i><b>3.1.2</b> How this fixes the problem</a></li>
<li class="chapter" data-level="3.1.3" data-path="solution.html"><a href="solution.html#summary"><i class="fa fa-check"></i><b>3.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="solution.html"><a href="solution.html#algorithm"><i class="fa fa-check"></i><b>3.2</b> Algorithmic implementation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="solution.html"><a href="solution.html#passes-1-2"><i class="fa fa-check"></i><b>3.2.1</b> Passes 1 &amp; 2</a></li>
<li class="chapter" data-level="3.2.2" data-path="solution.html"><a href="solution.html#pass-3"><i class="fa fa-check"></i><b>3.2.2</b> Pass 3</a></li>
<li class="chapter" data-level="3.2.3" data-path="solution.html"><a href="solution.html#pass-4"><i class="fa fa-check"></i><b>3.2.3</b> Pass 4</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="solution.html"><a href="solution.html#software"><i class="fa fa-check"></i><b>3.3</b> Software implementation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>4</b> Coding data</a><ul>
<li class="chapter" data-level="4.1" data-path="coding.html"><a href="coding.html#multiple-dependencies"><i class="fa fa-check"></i><b>4.1</b> Multiple dependencies</a></li>
<li class="chapter" data-level="4.2" data-path="coding.html"><a href="coding.html#invariant-characters-can-inform-parsimony"><i class="fa fa-check"></i><b>4.2</b> Invariant characters can inform parsimony</a></li>
<li class="chapter" data-level="4.3" data-path="coding.html"><a href="coding.html#puip"><i class="fa fa-check"></i><b>4.3</b> Variable but ‘parsimony uninformative’ characters can inform parsimony</a></li>
<li class="chapter" data-level="4.4" data-path="coding.html"><a href="coding.html#this-may-not-be-desirable-in-neomorphic-characters"><i class="fa fa-check"></i><b>4.4</b> This may not be desirable in neomorphic characters</a><ul>
<li class="chapter" data-level="4.4.1" data-path="coding.html"><a href="coding.html#three-scenarios"><i class="fa fa-check"></i><b>4.4.1</b> Three scenarios</a></li>
<li class="chapter" data-level="4.4.2" data-path="coding.html"><a href="coding.html#does-absence-contain-phylogenetic-information"><i class="fa fa-check"></i><b>4.4.2</b> Does absence contain phylogenetic information?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ambiguity.html"><a href="ambiguity.html"><i class="fa fa-check"></i><b>5</b> Coding ambiguity</a><ul>
<li class="chapter" data-level="5.1" data-path="ambiguity.html"><a href="ambiguity.html#principal-character-ambiguous"><i class="fa fa-check"></i><b>5.1</b> Principal character ambiguous</a></li>
<li class="chapter" data-level="5.2" data-path="ambiguity.html"><a href="ambiguity.html#principal-character-known"><i class="fa fa-check"></i><b>5.2</b> Principal character known</a><ul>
<li class="chapter" data-level="5.2.1" data-path="ambiguity.html"><a href="ambiguity.html#subordinate-character-has-finite-states"><i class="fa fa-check"></i><b>5.2.1</b> Subordinate character has finite states</a></li>
<li class="chapter" data-level="5.2.2" data-path="ambiguity.html"><a href="ambiguity.html#subordinate-character-may-have-unobserved-states"><i class="fa fa-check"></i><b>5.2.2</b> Subordinate character may have unobserved states</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ambiguity.html"><a href="ambiguity.html#recommendation"><i class="fa fa-check"></i><b>5.3</b> Recommendation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>6</b> Examples</a><ul>
<li class="chapter" data-level="6.1" data-path="examples.html"><a href="examples.html#some-caterpillars"><i class="fa fa-check"></i><b>6.1</b> Some caterpillars</a></li>
<li class="chapter" data-level="6.2" data-path="examples.html"><a href="examples.html#three-equally-suboptimal-alternatives"><i class="fa fa-check"></i><b>6.2</b> Three equally suboptimal alternatives</a></li>
<li class="chapter" data-level="6.3" data-path="examples.html"><a href="examples.html#a-better-caterpillar-tree"><i class="fa fa-check"></i><b>6.3</b> A better caterpillar tree</a></li>
<li class="chapter" data-level="6.4" data-path="examples.html"><a href="examples.html#de-laets-caterpillars"><i class="fa fa-check"></i><b>6.4</b> De Laet’s caterpillars</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
<li class="chapter" data-level="8" data-path="inapplicable-data-in-a-parsimony-setting.html"><a href="inapplicable-data-in-a-parsimony-setting.html"><i class="fa fa-check"></i><b>8</b> Inapplicable data in a parsimony setting</a></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/Inapp/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Fitch Algorithm</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">The Fitch Algorithm</h1>
<h4 class="author"><em>Thomas Guillerme; Martin R. Smith</em></h4>
<h4 class="date"><em>2018-03-08</em></h4>
</div>
<div id="fitch" class="section level1">
<h1><span class="header-section-number">1</span> The Fitch algorithm</h1>
<p>This algorithm was proposed by Fitch <span class="citation">(<a href="#ref-Fitch1971">1971</a>)</span> and is implemented in many phylogenetic softwares based on maximum parsimony <span class="citation">(Goloboff &amp; Catalano, <a href="#ref-Goloboff2016">2016</a>; Swofford, <a href="#ref-swofford2001paup">2001</a>)</span> or probabilistic methods <span class="citation">(Ronquist et al., <a href="#ref-Ronquist2012mrbayes">2012</a>; Stamatakis, <a href="#ref-Stamatakis2014">2014</a>)</span>.
The procedure is simple and elegant and entails going down the tree to count the number of transformations, and then going back up the tree to finalise the ancestral state reconstructions.</p>
<p>The way the algorithm goes up and down depends on the software, but often employs a <em>traversal</em>: a recursive function that can visit all tips and nodes in a logical fashion.
For example, consider the following tree:</p>
<div class="figure"><span id="fig:unnamed-chunk-2"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-2-1.png" alt="A five-tip tree" width="480" />
<p class="caption">
Figure 1.1: A five-tip tree
</p>
</div>
<p>A downpass traversal will first evaluate the first cherry (or pair of taxa) (<code>A</code> below), then save the results in <code>n1</code> and evaluate the second pair of tips/nodes (<code>B</code>), saving the results in <code>n2</code>, proceeding until all the nodes/tips are visited.</p>
<div class="figure"><span id="fig:unnamed-chunk-3"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-3-1.png" alt="Downpass traversal" width="480" />
<p class="caption">
Figure 1.2: Downpass traversal
</p>
</div>
<p>An uppass traversal works identically but in the other direction, going from the nodes towards the tips.</p>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-4-1.png" alt="Uppass traversal" width="480" />
<p class="caption">
Figure 1.3: Uppass traversal
</p>
</div>
<p>In both traversals, the sequence in which nodes are visited (i.e. which cherry to pick first in a downpass traversal, or whether to continue left or right in an uppass traversal) is arbitrary, provided that all tips and nodes are eventually visited.</p>
<p>Now let’s consider a more complex tree <code>((((a, b), c), d), (e, (f, (g, h))));</code> with a binary character distributed ((((1, 0), 0), 1), (1, (0, (0, 1)))):</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-5-1.png" width="576" /></p>
<p>We can use the <code>Inapp</code> package to apply the Fitch algorithm for this character on this tree.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Loading the Inapp package</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">library</span>(Inapp)</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"></div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">## The tree</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">tree &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="dt">text =</span> <span class="st">&quot;((((a, b), c), d), (e, (f, (g, h))));&quot;</span>)</div>
<div class="sourceLine" id="6" href="#6" data-line-number="6"></div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">## The character</div>
<div class="sourceLine" id="8" href="#8" data-line-number="8">character &lt;-<span class="st"> &quot;10011001&quot;</span></div>
<div class="sourceLine" id="9" href="#9" data-line-number="9"></div>
<div class="sourceLine" id="10" href="#10" data-line-number="10">## Applying the Fitch algorithm</div>
<div class="sourceLine" id="11" href="#11" data-line-number="11">matrix &lt;-<span class="st"> </span><span class="kw">apply.reconstruction</span>(tree, character, <span class="dt">method =</span> <span class="st">&quot;Fitch&quot;</span>, <span class="dt">passes =</span> <span class="dv">2</span>)</div></code></pre>
<div id="downpass" class="section level2">
<h2><span class="header-section-number">1.1</span> Downpass</h2>
<p>The downpass is quite simple and follows these rules for the two possible cases in the traversal:</p>
<ol style="list-style-type: decimal">
<li>If the two considered tips or nodes have <em>at least one state in common</em>, set the node to be these states in <em>common</em>.</li>
<li>Else, if there is <em>nothing in common</em> between the to tips or nodes, set the node to be the <em>union</em> of the two states.</li>
</ol>
<p>For example, node <code>n15</code> is case 2 because there is <em>nothing in common</em> between the tips <code>h</code> and <code>g</code> (states <code>1</code> and <code>0</code> respectively). Node <code>n14</code> is case 1 because there is <em>at least one state in common</em> between the tip <code>f</code> and the node <code>n15</code> (state <code>0</code>).</p>
<blockquote>
<p>Important: when the case 2 is encountered, a transformation is implied in the descendants of the considered node. The score of the tree is incremented by +1.</p>
</blockquote>
<p>In the following example, nodes that are in case 1 are in white and nodes in case 2, which imply a transformation (i.e. that add to the tree score), are in green.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Plotting the first downpass</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">plot.states.matrix</span>(matrix, <span class="dt">passes =</span> <span class="dv">1</span>, <span class="dt">counts =</span> <span class="dv">2</span>, <span class="dt">show.labels =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="kw">tiplabels</span>(char, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">bg =</span> Inapp<span class="op">::</span>brewer[[<span class="dv">2</span>]][char <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">adj =</span> <span class="dv">1</span>)</div></code></pre>
<div class="figure"><span id="fig:unnamed-chunk-7"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-7-1.png" alt="Node reconstructions after downpass" width="681.6" />
<p class="caption">
Figure 1.4: Node reconstructions after downpass
</p>
</div>
</div>
<div id="uppass" class="section level2">
<h2><span class="header-section-number">1.2</span> Uppass</h2>
<p>The score of the tree is known after the downpass, but the states of some nodes might not yet be properly resolved.
For example, parsimonious reconstructions exist that reconstruct node <code>n14</code> as state <code>1</code>, as opposed to the <code>0</code> presently reconstructed.
The present reconstruction seemingly indicates a change from state 1 to state 0 in an ancestor of <code>n14</code>, and a subsequent change from state 0 to state 1 in the ancestor of <code>h</code>, but an alternative reconstruction is equally parsimonious: <code>n13</code>, <code>n14</code> and <code>n15</code> may all have state <code>1</code>, with a change from state <code>1</code> to state <code>0</code> in each of the two lineages leading to <code>f</code> and <code>g</code>.</p>
<p>The uppass traversal employs the following rules:</p>
<ol style="list-style-type: decimal">
<li>If the current node and its ancestor have <em>all states in common</em>, the node is already resolved.</li>
<li>If there is <em>at least one state in common</em> between both left and right tips or nodes directly descended from the current node, resolve the node as being <em>the states in common</em> between its ancestor and both his descendants.</li>
<li>If there is <em>there are no states in common</em> between its descendants, resolve the node as being <em>the states in common</em> between the ancestor and the current node.</li>
</ol>
<p>For example, node <code>n13</code> is already resolved (it has all its states in common with the ancestor - case 1).
Node <code>n14</code> has not all its states in common with its ancestor but its two descendants (<code>n15</code> and <code>f</code>) have at least one state in common (<code>0</code>).
This node is thus solved to be the states in common between both descendants (<code>01</code>) and its ancestor (<code>01</code> as well).</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Plotting the first uppass</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">plot.states.matrix</span>(matrix, <span class="dt">passes =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">counts =</span> <span class="dv">2</span>,</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">                   <span class="dt">show.labels =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col.states=</span><span class="ot">TRUE</span>)</div></code></pre>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-8-1.png" alt="Node reconstructions after uppass" width="681.6" />
<p class="caption">
Figure 1.5: Node reconstructions after uppass
</p>
</div>
<p>More complex cases can be studied in the Inapp App (running in your favourite web browser) by switching the <strong><code>Reconstruction method</code></strong> to <strong><code>Normal Fitch</code></strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Running the Inapp App</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="kw">runInapp</span>()</div></code></pre>
</div>
<div id="resolving-ambiguous-resolutions" class="section level2">
<h2><span class="header-section-number">1.3</span> Resolving ambiguous resolutions</h2>
<p>In certain cases, it is necessary to go further and discriminate between the equally-parsimonious reconstructions provided by the Fitch algorithm.
A number of approaches have been proposed concerning which resolution of ambiguous
nodes is preferable.</p>
<p>The two most familiar approaches to resolving ambiguous node are the Accelerated Transformation (<span class="smallcaps">AccTran</span>) and Delayed Transformation (<span class="smallcaps">DelTran</span>) approaches.</p>
<p>The <span class="smallcaps">AccTran</span> approach reconstructs transformations as occurring as close to the root as possible; the <span class="smallcaps">DelTran</span>, as far from the root as possible.</p>
<p>In this case, the ambiguous resolution of the root leaves two options for the latter:</p>
<div class="figure"><span id="fig:unnamed-chunk-10"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-10-1.png" alt="Node reconstructions after AccTran or DelTran` optimizations" width="681.6" />
<p class="caption">
Figure 1.6: Node reconstructions after AccTran or DelTran` optimizations
</p>
</div>
<p>If the states <code>0</code> and <code>1</code> represent states of a transformational character –
whether an organism’s tail is red or blue, say – then there is no reason to prefer
any of the equally-parsimonious reconstructions, as none implies any more homology
than any other.</p>
<p>With neomorphic characters, however, state <code>0</code> stands for the absence of a character
– for example, a tail –
and state <code>1</code> its presence. On one view, a reconstruction that minimises the number
of times that such a character evolves attributes more similarity to homology than
an equally parsimonious reconstruction in which said character is gained multiple times
independently.</p>
<div id="maximising-homology" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Maximising homology</h3>
<p>Neither <span class="smallcaps">AccTran</span> nor <span class="smallcaps">DelTran</span> is guaranteed to maximise homology <span class="citation">(Agnarsson &amp; Miller, <a href="#ref-Agnarsson2008">2008</a>)</span>.
In this particular case, the <span class="smallcaps">DelTran</span> reconstruction maximises homology. If the
character denotes the presence or absence of a tail, then this reconstruction invokes the presence of a tail in the common ancestor of all taxa, meaning that the tails present in
tips <code>a</code>, <code>d</code>, <code>e</code> and <code>h</code> are homologous with one another.
The <span class="smallcaps">AccTran</span> reconstruction, in contrast, identifies a loss of a tail
at nodes 11 and 14, with a tail evolving independently in tips <code>a</code> and <code>h</code>.
Under this reconstruction, the tails of <code>a</code> and <code>h</code> are not homologous with each other, or with the tails of <code>d</code> and <code>e</code>.
(The alternative <span class="smallcaps">DelTran</span> approach, which could arguably be described as <span class="smallcaps">AccTran</span> instead, invokes four independent origins of the character and clearly does not maximise its homology.)</p>
<p>Where we wish to maximise homology, we modify the Fitch uppass such that any node
whose final state reconstruction would be ambiguous is instead reconstructed as present when that node is encountered.
This approach maximises homology in the problematic trees presented by
Agnarsson &amp; Miller [<span class="citation">(<a href="#ref-Agnarsson2008">2008</a>)</span>; “A&amp;M” below]:</p>
<div class="figure"><span id="fig:unnamed-chunk-11"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-11-1.png" alt="Homology-maximising character optimisations" width="681.6" />
<p class="caption">
Figure 1.7: Homology-maximising character optimisations
</p>
</div>
<p>This approach is also robust to missing entries:</p>
<div class="figure"><span id="fig:unnamed-chunk-12"></span>
<img src="Inapplicable_data_files/figure-html/unnamed-chunk-12-1.png" alt="Homology maximisation with missing entries" width="681.6" />
<p class="caption">
Figure 1.8: Homology maximisation with missing entries
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Fitch1971">
<p>Fitch, W. M. (1971). Toward defining the course of evolution: minimum change for a specific tree topology. <em>Systematic Biology</em>, <em>20</em>(4), 406–416. doi:<a href="https://doi.org/10.1093/sysbio/20.4.406">10.1093/sysbio/20.4.406</a></p>
</div>
<div id="ref-Goloboff2016">
<p>Goloboff, P. A., &amp; Catalano, S. A. (2016). TNT version 1.5, including a full implementation of phylogenetic morphometrics. <em>Cladistics</em>, <em>32</em>(3), 221–238. doi:<a href="https://doi.org/10.1111/cla.12160">10.1111/cla.12160</a></p>
</div>
<div id="ref-swofford2001paup">
<p>Swofford, D. L. (2001). PAUP*: Phylogenetic analysis using parsimony (and other methods) 4.0. B5.</p>
</div>
<div id="ref-Ronquist2012mrbayes">
<p>Ronquist, F., Teslenko, M., Mark, P. van der, Ayres, D. L., Darling, A., Hohna, S., … Huelsenbeck, J. P. (2012). MrBayes 3.2: Efficient Bayesian phylogenetic inference and model choice across a large model space. <em>Systematic Biology</em>, <em>61</em>(3), 539–42.</p>
</div>
<div id="ref-Stamatakis2014">
<p>Stamatakis, A. (2014). RAxML version 8: A tool for phylogenetic analysis and post-analysis of large phylogenies. <em>Bioinformatics</em>, <em>30</em>(9), 1312–1313. doi:<a href="https://doi.org/10.1093/bioinformatics/btu033">10.1093/bioinformatics/btu033</a></p>
</div>
<div id="ref-Agnarsson2008">
<p>Agnarsson, I., &amp; Miller, J. A. (2008). Is <span class="smallcaps">AccTran</span> better than <span class="smallcaps">DelTran</span>? <em>Cladistics</em>, <em>24</em>(6), 1032–1038. doi:<a href="https://doi.org/10.1111/j.1096-0031.2008.00229.x">10.1111/j.1096-0031.2008.00229.x</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="problems.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/Inapp/inst/gitbook/edit/master/01_Fitch.Rmd",
"text": "Edit"
},
"download": ["Inapplicable_data.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
