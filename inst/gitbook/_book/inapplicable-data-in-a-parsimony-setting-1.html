<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Inapplicable data</title>
  <meta name="description" content="Inapplicable data in a parsimony setting">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Inapplicable data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inapplicable data in a parsimony setting" />
  <meta name="github-repo" content="TGuillerme/Inapp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Inapplicable data" />
  
  <meta name="twitter:description" content="Inapplicable data in a parsimony setting" />
  

<meta name="author" content="Martin Brazeau (m.brazeau@imperial.ac.uk), Thomas Guillerme (guillert@tcd.ie) and Martin Smith (martin.smith@durham.ac.uk)">


<meta name="date" content="2018-02-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="our-solution.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Inapplicable data in a parsimony setting</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Inapplicable data in a parsimony setting</a></li>
<li class="chapter" data-level="2" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html"><i class="fa fa-check"></i><b>2</b> The Fitch algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#downpass"><i class="fa fa-check"></i><b>2.1</b> Downpass</a></li>
<li class="chapter" data-level="2.2" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#uppass"><i class="fa fa-check"></i><b>2.2</b> Uppass</a></li>
<li class="chapter" data-level="2.3" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#discussion-how-to-optimise-characters"><i class="fa fa-check"></i><b>2.3</b> Discussion: How to optimise characters</a></li>
<li class="chapter" data-level="2.4" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#problems-with-the-fitch-algorithm"><i class="fa fa-check"></i><b>2.4</b> Problems with the Fitch algorithm</a><ul>
<li class="chapter" data-level="2.4.1" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#red-tails-blue-tails"><i class="fa fa-check"></i><b>2.4.1</b> Red tails, blue tails</a></li>
<li class="chapter" data-level="2.4.2" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#why-reductive-coding-doesnt-work"><i class="fa fa-check"></i><b>2.4.2</b> Why Reductive coding doesn’t work</a></li>
<li class="chapter" data-level="2.4.3" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#why-extra-state-doesnt-work"><i class="fa fa-check"></i><b>2.4.3</b> Why Extra State doesn’t work</a></li>
<li class="chapter" data-level="2.4.4" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#why-a-single-multi-state-character-doesnt-work"><i class="fa fa-check"></i><b>2.4.4</b> Why a single multi-state character doesn’t work</a></li>
<li class="chapter" data-level="2.4.5" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#sankoff-matrices"><i class="fa fa-check"></i><b>2.4.5</b> Sankoff matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
<li class="chapter" data-level="2.6" data-path="the-fitch-algorithm.html"><a href="the-fitch-algorithm.html#counting-steps-is-doomed"><i class="fa fa-check"></i><b>2.6</b> Counting steps is doomed</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="our-solution.html"><a href="our-solution.html"><i class="fa fa-check"></i><b>3</b> Our solution</a><ul>
<li class="chapter" data-level="3.1" data-path="our-solution.html"><a href="our-solution.html#what-we-count"><i class="fa fa-check"></i><b>3.1</b> What we count</a><ul>
<li class="chapter" data-level="3.1.1" data-path="our-solution.html"><a href="our-solution.html#what-does-it-take-to-denote-separate-regions"><i class="fa fa-check"></i><b>3.1.1</b> What does it take to denote separate regions?</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="our-solution.html"><a href="our-solution.html#how-this-fixes-the-problem"><i class="fa fa-check"></i><b>3.2</b> How this fixes the problem</a></li>
<li class="chapter" data-level="3.3" data-path="our-solution.html"><a href="our-solution.html#furhter-examples"><i class="fa fa-check"></i><b>3.3</b> Furhter examples</a></li>
<li class="chapter" data-level="3.4" data-path="our-solution.html"><a href="our-solution.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
<li class="chapter" data-level="3.5" data-path="our-solution.html"><a href="our-solution.html#implementation"><i class="fa fa-check"></i><b>3.5</b> Implementation</a><ul>
<li class="chapter" data-level="3.5.1" data-path="our-solution.html"><a href="our-solution.html#passes-1-2"><i class="fa fa-check"></i><b>3.5.1</b> Passes 1 &amp; 2</a></li>
<li class="chapter" data-level="3.5.2" data-path="our-solution.html"><a href="our-solution.html#pass-3"><i class="fa fa-check"></i><b>3.5.2</b> Pass 3</a></li>
<li class="chapter" data-level="3.5.3" data-path="our-solution.html"><a href="our-solution.html#pass-4"><i class="fa fa-check"></i><b>3.5.3</b> Pass 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html"><i class="fa fa-check"></i><b>4</b> Inapplicable data in a parsimony setting</a><ul>
<li class="chapter" data-level="4.1" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#how-this-algorithm-weights-against-multiple-innovations"><i class="fa fa-check"></i><b>4.1</b> How this algorithm weights against multiple innovations</a></li>
<li class="chapter" data-level="4.2" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#multiple-dependencies"><i class="fa fa-check"></i><b>4.2</b> Multiple dependencies</a></li>
<li class="chapter" data-level="4.3" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#a-parsimony-uninformative-character-that-informs-parsimony"><i class="fa fa-check"></i><b>4.3</b> A parsimony uninformative character that informs parsimony!</a><ul>
<li class="chapter" data-level="4.3.1" data-path="inapplicable-data-in-a-parsimony-setting-1.html"><a href="inapplicable-data-in-a-parsimony-setting-1.html#difficulties"><i class="fa fa-check"></i><b>4.3.1</b> Difficulties</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/Inapp/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Inapplicable data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inapplicable-data-in-a-parsimony-setting-1" class="section level1">
<h1><span class="header-section-number">4</span> Inapplicable data in a parsimony setting</h1>
<p>This is one of a <a href="Index.html">series</a> of vignettes that works through the inapplicable algorithm proposed by Brazeau <em>et al.</em> <span class="citation">(<a href="#ref-ThisStudy">2017</a>)</span>.</p>
<p>We assume that you’ll already have read the <a href="OurAlgorithm.html">description</a> of our algorithm.</p>
<div id="how-this-algorithm-weights-against-multiple-innovations" class="section level2">
<h2><span class="header-section-number">4.1</span> How this algorithm weights against multiple innovations</h2>
<p>We discussed in an <a href="FailedSolutions.html">earlier vignette</a> that, if we only penalise transformations between states in subsidiary characters, trees that imply multiple origins of the parent character receive much lower scores than those in which the parent character evolves once (but its subsidiary characteristics change multiple times).</p>
<p>Our algorithm counterbalances this by, in effect, imposing a cost for each additional origin of the parent character. At first blush, this sounds like it is weighting against multiple innovations of the parent character – but this isn’t so; it weights against multiple independent innovations of the SAME state (i.e. homoplasy), but if a red tail evolved here and a blue tail evolved there, then two innovations of the tail imposes a cost of one (additional region) for tail colour, whereas a single innovation of the tail would also impose a cost of one (transformation) for tail colour. The additional origin of the tail can</p>
<ul>
<li>This has a side-effect that we’ll study with an invariant character</li>
</ul>
</div>
<div id="multiple-dependencies" class="section level2">
<h2><span class="header-section-number">4.2</span> Multiple dependencies</h2>
<p>It’s not a problem to have characters dependent on characters that are dependent on characters. Consider the following character heirarchy:</p>
<ol style="list-style-type: decimal">
<li>Appendages: (0), absent; (1), present.</li>
<li>Appendage termination: (0), blunt; (1), claw; (2), sucker.</li>
<li>Claw morphology: (0), smooth; (1), serrated.</li>
<li>Sucker morphology: (0), round; (1), polygonal.</li>
</ol>
<p>The included taxa may or may not bear appendages; if they do, then the appendages may end either with either claws or suckers, or neither (but not both). Claws come in two flavours, smooth and serrated; suckers come in two shapes, rounded and polygonal.</p>
<p>If character 1 (appendages) is absent, then characters 2–4 are inapplicable. Otherwise, charcter 2 (appendage termination) must take one of the three applicable values.</p>
<p>If character 2 (termination) has state 0 (blunt), then characters 3 and 4 (morphology of claw / sucker) are inapplicable.</p>
<p>If character 2 (termination) has state 1 (claw), then character 3 (claw morphology) is applicable and character 4 (sucker morphology) is inapplicable.</p>
<p>If character 2 (termination) has state 2 (sucker), then character 3 (claw morphology) is inapplicable and character 4 (sucker morphology) is applicable.</p>
<p>A sample character matrix might look like this:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">C</th>
<th align="left">D</th>
<th align="left">E</th>
<th align="left">F</th>
<th align="left">G</th>
<th align="left">H</th>
<th align="left">I</th>
<th align="left">J</th>
<th align="left">K</th>
<th align="left">L</th>
<th align="left">M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Appendages: (0), absent; (1), present.</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td>Appendage termination: (0), blunt; (1), claw; (2), sucker.</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td>Claw morphology: (0), smooth; (1), serrated.</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr class="even">
<td>Sucker morphology: (0), round; (1), polygonal.</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
<p>Which would plot on a tree thus:</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
</div>
<div id="a-parsimony-uninformative-character-that-informs-parsimony" class="section level2">
<h2><span class="header-section-number">4.3</span> A parsimony uninformative character that informs parsimony!</h2>
<ul>
<li><p>All tails are blue. Let’s say that they are all blue for some complex molecular reason, such that it is most parsimonious if “blueness” has a single evolutionary origin.</p>
<table>
<thead>
<tr class="header">
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
<th align="center">D</th>
<th align="center">E</th>
<th align="center">F</th>
<th align="center">G</th>
<th align="center">H</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Tail: (0), absent; (1), present</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td>1</td>
</tr>
<tr class="even">
<td align="center">Tail colour: (-), inapplicable; (1), blue</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">-</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td>1</td>
</tr>
<tr class="odd">
<td align="center">Body colour: (1), black; (2), white</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">1</td>
<td>1</td>
</tr>
</tbody>
</table></li>
<li>This complex molecular reason is grounds to suspect that the tails have a common ancestor</li>
<li>More formally, we wish to attribute this complex molecular reason to common ancestry, rather than homoplasy</li>
<li><p>Thus “blueness” represents a separate character that has the same distribution as tails (or a sbuset thereof, if some tails are of uncertain colour)</p></li>
</ul>
<p>Let’s compare two trees. One groups taxa based on the presence of tails; the other groups taxa based on body colour.</p>
<p><img src="Inapplicable_data_files/figure-html/unnamed-chunk-30-1.png" width="768" /><img src="Inapplicable_data_files/figure-html/unnamed-chunk-30-2.png" width="768" /><img src="Inapplicable_data_files/figure-html/unnamed-chunk-30-3.png" width="768" /></p>
<ul>
<li><p>So the tree on the left, which reconstructs a single origin of the tail, a single origin of a blue tail colouration, and two changes in body colour, is preferred to the tree on the right, which reconstructs a single change in body colour but two origins of the tail, and two origins of blue colouration on the tail.</p></li>
<li><p>We should include this character if it’s meaningful. But not if it’s not (e.g. number of base pairs in a tail).</p></li>
</ul>
<div id="difficulties" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Difficulties</h3>
<p><mark>Here are some marginal cases where discretion is required.</mark></p>
<p><mark>Here are some trees that show why we would code things our way this is why you need to look at your data carefully and see whether you like what your mode of coding is implying!</mark></p>
<p><a href="Index.html">Return to index</a> | <a href="Neomorphics.html">Coding neomorphic characters</a> | <a href="AmbiguousData.html">Coding ambiguous data</a> <!-- 
## References
 --></p>

<div id="refs" class="references">
<div>
<p>Agnarsson, I., &amp; Miller, J. A. (2008). Is ACCTRAN better than DELTRAN? <em>Cladistics</em>, <em>24</em>(6), 1032–1038. doi:<a href="https://doi.org/10.1111/j.1096-0031.2008.00229.x">10.1111/j.1096-0031.2008.00229.x</a></p>
</div>
<div>
<p>Brazeau, M. D., Guillerme, T., &amp; Smith, M. R. (2017). Morphological phylogenetic analysis with inapplicable data. <em>bioR<span class="math inline">\(\chi\)</span>iv</em>. doi:<a href="https://doi.org/10.1101/209775">10.1101/209775</a></p>
</div>
<div>
<p>Fitch, W. M. (1971). Toward defining the course of evolution: minimum change for a specific tree topology. <em>Systematic Biology</em>, <em>20</em>(4), 406–416. doi:<a href="https://doi.org/10.1093/sysbio/20.4.406">10.1093/sysbio/20.4.406</a></p>
</div>
<div>
<p>Maddison, W. P. (1993). Missing data versus missing characters in phylogenetic analysis. <em>Systematic Biology</em>, <em>42</em>(4), 576–581. doi:<a href="https://doi.org/10.1093/sysbio/42.4.576">10.1093/sysbio/42.4.576</a></p>
</div>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-ThisStudy">
<p>Brazeau, M. D., Guillerme, T., &amp; Smith, M. R. (2017). Morphological phylogenetic analysis with inapplicable data. <em>bioR<span class="math inline">\(\chi\)</span>iv</em>. doi:<a href="https://doi.org/10.1101/209775">10.1101/209775</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="our-solution.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/Inapp/inst/gitbook/edit/master/06_CodingData.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
