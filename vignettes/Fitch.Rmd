---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Inapplicable data in a parsimony setting

This is one of a series of vignettes that works through the inapplicable algorithm proposed by Brazeau et al [@ThisStudy].


## The Fitch algorithm

### Downpass

- Scoring occurs on downpass

```{r Fitch Downpass, echo=FALSE}
tree=ape::read.tree(text="((((a, b), c), d), (e, (f, (g, h))));")
character <- "10011001"
matrix <- apply.reconstruction(tree, character)
plot.states.matrix(matrix, 1, counts=2)
```

### Uppass
- Character states finalised on uppass

```{r Fitch Uppass, echo=FALSE}
tree=ape::read.tree(text="((((a, b), c), d), (e, (f, (g, h))));")
character <- "10011001"
matrix <- apply.reconstruction(tree, character, method="Fitch")
plot.states.matrix(matrix, 1:2, counts=2)
```


### Discussion: How to optimise characters

- Acctran vs Deltran: Neither is guaranteed to always maximise homology
- With transformational characters, there's no way to decide.
- With neomorphic characters though, we want to assume the minimum number of innovations of the innovation.
- This is what we mean by maximising homology: always assume a neomorphic character is present if you can
- Here's how we'd resolve the ambiguous trees from [@AccTranVsDelTran2008].



## References
